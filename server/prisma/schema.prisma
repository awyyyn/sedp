
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model SystemUser {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  email String @unique
  firstName String
  lastName String
  displayName String
  password String
  mfaSecret String?
  mfaEnabled Boolean @default(false)
  address address 
  emailVerifiedAt DateTime?
  emailVerified Boolean @default(false)
  role SystemUserRole
  status SystemUserStatus @default(UNVERIFIED)

  // TimeStamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("system_users")
}

enum SystemUserStatus {
  VERIFIED
  UNVERIFIED
  ARCHIVED
}

enum SystemUserRole {
  SUPER_ADMIN
  ADMIN
}

model student {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  email String @unique
  firstName String
  lastName String 
  middleName String?
  address address
  password String
  birthDate DateTime
  mfaSecret String?
  mfaEnabled Boolean @default(false)
  schoolYear String 
  schoolName String
  emailVerifiedAt DateTime?
  emailVerified Boolean @default(false)
  documents documents[]

  // TimeStamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("students")
}

type address {
  street String
  city String
  province String
  zip Int
}

model token {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  email String @unique
  token String
  time  DateTime  

  @@map("tokens")
}


enum documentTypeEnum {
  photo
  document
}

model documents {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  student student @relation(fields: [studentId], references: [id])
  studentId String  @db.ObjectId
  documentType documentTypeEnum @default(photo)
  documentName String
  documentUrl String 

  

  // TimeStamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("documents")
}
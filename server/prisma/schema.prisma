
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model SystemUser {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  email String @unique
  firstName String
  lastName String
  middleName String?
  displayName String
  password String
  mfaSecret String?
  phoneNumber String
  birthDate DateTime
  mfaEnabled Boolean @default(false) 
  address address 
  role SystemUserRole
  status SystemUserStatus @default(UNVERIFIED)

  // TimeStamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("system_users")
}

enum SystemUserStatus {
  VERIFIED
  UNVERIFIED
  DELETED
}

enum SystemUserRole {
  SUPER_ADMIN
  ADMIN
}

model student {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  studentId String @unique
  email String @unique
  firstName String
  lastName String 
  middleName String?
  address address
  password String
  birthDate DateTime
  phoneNumber String
  status StudentStatus @default(SCHOLAR)

  mfaSecret String?
  mfaEnabled Boolean @default(false) 

  yearLevel Int 
  schoolName String  

  documents documents[]

  // TimeStamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("students")
}

type address {
  street String
  city String 
}

enum StudentStatus {
  REQUESTING
  SCHOLAR
  GRADUATED
  DISQUALIFIED
  ARCHIVED
}

 
model token {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  email String @unique
  token String
  time  DateTime  

  @@map("tokens")
}

enum documentTypeEnum {
  photo
  document
}

model documents {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  student student @relation(fields: [studentId], references: [id])
  studentId String  @db.ObjectId
  documentType documentTypeEnum @default(photo)
  documentName String
  documentUrl String 

  

  // TimeStamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("documents")
}